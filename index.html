<!DOCTYPE html>
<html>
<head>
    <title>College SOS System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to right, #ff4e50, #f9d423);
            text-align: center;
            margin: 0;
            padding-top: 40px;
        }

        .container {
            background: white;
            padding: 25px;
            width: 90%;
            max-width: 350px;
            margin: auto;
            border-radius: 15px;
            box-shadow: 0px 5px 20px rgba(0,0,0,0.2);
        }

        h1 {
            margin-bottom: 20px;
        }

        input {
            width: 95%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        .saveBtn {
            background: #28a745;
            color: white;
            padding: 12px;
            border: none;
            width: 100%;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }

        .sosBtn {
            background: red;
            color: white;
            padding: 18px;
            border: none;
            width: 100%;
            font-size: 20px;
            margin-top: 20px;
            cursor: pointer;
            border-radius: 50px;
            font-weight: bold;
        }

        .sosBtn:hover {
            background: darkred;
        }

        #status {
            margin-top: 15px;
            font-weight: bold;
            min-height: 20px;
        }
    </style>
</head>

<body>

<div class="container">
    <h1>ðŸš¨ College SOS System</h1>

    <input type="tel" id="contactNumber" placeholder="Enter Emergency Contact Number">
    <input type="tel" id="policeNumber" placeholder="Enter Police Number">

    <button class="saveBtn" onclick="saveNumbers()">Save Numbers</button>

    <button class="sosBtn" onclick="triggerSOS()">SOS</button>

    <p id="status"></p>
</div>

<script>

function saveNumbers() {
    const contact = document.getElementById("contactNumber").value;
    const police = document.getElementById("policeNumber").value;

    if(contact === "" || police === "") {
        alert("Please enter both numbers!");
        return;
    }

    localStorage.setItem("contactNumber", contact);
    localStorage.setItem("policeNumber", police);

    alert("Numbers Saved Successfully!");
}

function triggerSOS() {

    const contact = localStorage.getItem("contactNumber");
    const police = localStorage.getItem("policeNumber");

    if (!contact || !police) {
        alert("Please save numbers first!");
        return;
    }

    document.getElementById("status").innerText = "Getting your location...";

    if (!navigator.geolocation) {
        alert("Geolocation not supported!");
        return;
    }

    navigator.geolocation.getCurrentPosition(function(position) {

        const lat = position.coords.latitude;
        const lon = position.coords.longitude;

        const locationLink = `https://www.google.com/maps?q=${lat},${lon}`;
        const message = `ðŸš¨ EMERGENCY! I need help. My location: ${locationLink}`;

        document.getElementById("status").innerText = "Calling Emergency Contact...";

        // 1ï¸âƒ£ CALL FIRST
        window.location.href = `tel:${contact}`;

        // 2ï¸âƒ£ AFTER 4 SEC SEND SMS
        setTimeout(() => {
            document.getElementById("status").innerText = "Sending SMS...";
            window.location.href = `sms:${contact}?body=${encodeURIComponent(message)}`;
        }, 4000);

        // 3ï¸âƒ£ AFTER 15 SEC SIMULATED POLICE ALERT
        setTimeout(() => {
            document.getElementById("status").innerText = "No Response! Alerting Police...";
            window.location.href = `sms:${police}?body=${encodeURIComponent("Emergency! No response from primary contact. Location: " + locationLink)}`;
        }, 15000);

    }, function(error) {
        alert("Location access denied! Please allow location permission.");
    });
}

</script>

</body>
</html>
